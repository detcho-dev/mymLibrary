<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>MYM Library - Login / Sign Up</title>
    <!-- Firebase App (the core Firebase SDK) is always required -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <!-- Add Firestore -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script>
      // ØªÙ‡ÙŠØ¦Ø© Firebase Config Ù…Ø¨Ø§Ø´Ø±Ø©
      const firebaseConfig = {
        apiKey: "AIzaSyB1OVx-YSmPFeq3lp-gAGe576yG1RhMLYs",
        authDomain: "mymlibraryreads.firebaseapp.com",
        projectId: "mymlibraryreads",
        storageBucket: "mymlibraryreads.firebasestorage.app",
        messagingSenderId: "11947740896",
        appId: "1:11947740896:web:87482eb72210acdba50a85",
      };

      // ØªÙ‡ÙŠØ¦Ø© Firebase
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore(); // ğŸ‘ˆ Ù‡Ø°Ø§ Ù‡Ùˆ Firestore
    </script>

    <style>
      :root {
        --dark-bg: #121212;
        --card-bg: rgba(30, 30, 30, 0.7); /* Ø´ÙØ§Ù */
        --card-blur: 10px; /* ØªØ£Ø«ÙŠØ± blur */
        --border-color: rgba(255, 255, 255, 0.1); /* Ø´ÙØ§Ù */
        --primary-color: #6c5ce7;
        --primary-hover: #5d4fc7;
        --text-primary: #f8f9fa;
        --text-secondary: #adb5bd;
        --error-color: #ff6b6b;
        --success-color: #4caf50;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: url("pexels-adrien-olichon-1257089-2387532.jpg") no-repeat
          center center fixed; /* Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© */
        background-size: cover;
        color: var(--text-primary);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
        direction: ltr; /* Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù…Ù† Ø§Ù„ÙŠØ³Ø§Ø± Ù„Ù„ÙŠÙ…ÙŠÙ† */
        transition: direction 0.3s;
        position: relative; /* Ù„ÙˆØ¶Ø¹ blur layer */
      }

      body::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: inherit; /* Ø§Ù†Ø³Ø® Ø§Ù„Ø®Ù„ÙÙŠØ© */
        filter: blur(var(--card-blur)); /* ØªØ£Ø«ÙŠØ± blur */
        z-index: -1; /* ÙˆØ±Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
      }

      body[dir="rtl"] {
        direction: rtl; /* ØªØºÙŠÙŠØ± Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø¹Ù†Ø¯ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© */
      }

      .auth-container {
        background: var(--card-bg);
        border-radius: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        overflow: hidden;
        width: 100%;
        max-width: 450px;
        border: 1px solid var(--border-color);
        position: relative; /* Ù„ÙˆØ¶Ø¹ Ø²Ø± Ø§Ù„Ù„ØºØ© */
        backdrop-filter: blur(var(--card-blur)); /* blur Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒØ§Ø±Øª */
      }

      .language-toggle {
        position: absolute;
        top: 10px;
        right: 10px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 5px;
        padding: 5px 10px;
        cursor: pointer;
        font-size: 0.9rem;
        z-index: 1; /* ÙÙˆÙ‚ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
      }

      .logo-container {
        text-align: center;
        margin-bottom: 30px;
      }

      .logo {
        font-size: 2.5rem;
        font-weight: 800;
        background: linear-gradient(90deg, #6c5ce7, #a29bfe);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 8px;
      }

      .logo-text {
        color: var(--text-secondary);
        font-size: 1.1rem;
      }

      .tabs {
        display: flex;
        background: rgba(30, 30, 30, 0.7);
        border-bottom: 1px solid var(--border-color);
      }

      .tab {
        flex: 1;
        padding: 16px;
        text-align: center;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        color: var(--text-secondary);
      }

      .tab.active {
        color: var(--primary-color);
        background: rgba(108, 92, 231, 0.1);
        border-bottom: 3px solid var(--primary-color);
      }

      .tab:hover:not(.active) {
        color: var(--text-primary);
      }

      .form-container {
        padding: 30px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--text-secondary);
      }

      .form-control {
        width: 100%;
        padding: 14px;
        border: 1px solid var(--border-color);
        border-radius: 10px;
        background: rgba(30, 30, 30, 0.8);
        color: var(--text-primary);
        font-size: 16px;
        transition: border-color 0.3s;
      }

      .form-control:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(108, 92, 231, 0.3);
      }

      .form-control::placeholder {
        color: #555;
      }

      .btn {
        width: 100%;
        padding: 14px;
        border: none;
        border-radius: 10px;
        background: var(--primary-color);
        color: white;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 10px;
      }

      .btn:hover {
        background: var(--primary-hover);
        transform: translateY(-2px);
      }

      .btn:active {
        transform: translateY(0);
      }

      .error-message {
        color: var(--error-color);
        text-align: center;
        margin: 15px 0;
        min-height: 24px;
        font-size: 14px;
      }

      .success-message {
        color: var(--success-color);
        text-align: center;
        margin: 15px 0;
        min-height: 24px;
        font-size: 14px;
      }

      .divider {
        display: flex;
        align-items: center;
        margin: 25px 0;
      }

      .divider::before,
      .divider::after {
        content: "";
        flex: 1;
        height: 1px;
        background: var(--border-color);
      }

      .divider span {
        padding: 0 15px;
        color: var(--text-secondary);
        font-size: 14px;
      }

      .firebase-logo {
        text-align: center;
        margin-top: 20px;
        color: var(--text-secondary);
        font-size: 14px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
      }

      .firebase-icon {
        font-size: 20px;
        color: #ffca28;
      }

      .hidden {
        display: none;
      }

      /* Responsive Design */
      @media (max-width: 480px) {
        .form-container {
          padding: 20px;
        }

        .logo {
          font-size: 2rem;
        }

        .language-toggle {
          top: 5px;
          right: 5px;
          font-size: 0.8rem;
          padding: 4px 8px;
        }
      }

      /* Zoom 200% */
      @media (min-resolution: 2dppx) {
        body {
          font-size: 0.8em; /* ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø®Ø· Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„ØªÙƒØ¨ÙŠØ± */
        }
        .auth-container {
          max-width: 90vw; /* Ø¬Ø¹Ù„ Ø§Ù„ÙƒØ§Ø±Øª Ø£ØµØºØ± Ù†Ø³Ø¨ÙŠÙ‹Ø§ */
        }
      }
    </style>
  </head>
  <body>
    <div class="auth-container">
      <button
        class="language-toggle"
        id="lang-toggle"
        onclick="toggleLanguage()"
      >
        Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
      </button>
      <div class="logo-container">
        <div class="logo" id="logo-text">MYM Library</div>
        <div class="logo-text" id="logo-subtitle">
          Access your personal book collection
        </div>
      </div>

      <div class="tabs">
        <div class="tab active" data-tab="login" id="tab-login">Login</div>
        <div class="tab" data-tab="signup" id="tab-signup">Sign Up</div>
      </div>

      <div class="form-container">
        <form id="login-form">
          <div class="error-message" id="login-error"></div>
          <div class="success-message" id="login-success"></div>

          <div class="form-group">
            <label for="login-email" id="label-login-email"
              >Email Address</label
            >
            <input
              type="email"
              id="login-email"
              class="form-control"
              placeholder="your@email.com"
              required
            />
          </div>

          <div class="form-group">
            <label for="login-password" id="label-login-password"
              >Password</label
            >
            <input
              type="password"
              id="login-password"
              class="form-control"
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              required
            />
          </div>

          <button type="submit" class="btn" id="btn-login">
            Log In to Your Account
          </button>
        </form>

        <form id="signup-form" class="hidden">
          <div class="error-message" id="signup-error"></div>
          <div class="success-message" id="signup-success"></div>

          <div class="form-group">
            <label for="signup-name" id="label-signup-name">Full Name</label>
            <input
              type="text"
              id="signup-name"
              class="form-control"
              placeholder="John Doe"
              required
            />
          </div>

          <div class="form-group">
            <label for="signup-email" id="label-signup-email"
              >Email Address</label
            >
            <input
              type="email"
              id="signup-email"
              class="form-control"
              placeholder="your@email.com"
              required
            />
          </div>

          <div class="form-group">
            <label for="signup-password" id="label-signup-password"
              >Password</label
            >
            <input
              type="password"
              id="signup-password"
              class="form-control"
              placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
              required
            />
          </div>

          <button type="submit" class="btn" id="btn-signup">
            Create Your Account
          </button>
        </form>
      </div>
    </div>

    <script>
      // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„ØºØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      let currentLanguage = "en"; // Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ

      // Ù‚ÙˆØ§Ù…ÙŠØ³ Ø§Ù„ØªØ±Ø¬Ù…Ø©
      const translations = {
        en: {
          "logo-text": "MYM Library",
          "logo-subtitle": "Access your personal book collection",
          "tab-login": "Login",
          "tab-signup": "Sign Up",
          "label-login-email": "Email Address",
          "label-login-password": "Password",
          "btn-login": "Log In to Your Account",
          "label-signup-name": "Full Name",
          "label-signup-email": "Email Address",
          "label-signup-password": "Password",
          "btn-signup": "Create Your Account",
          "divider-text": "or continue with",
          "firebase-text": "Firebase Firestore",
          "error-email-required": "Please enter your email address.",
          "error-password-required": "Please enter your password.",
          "error-name-required": "Please enter your full name.",
          "error-credentials": "Please check your credentials and try again.",
          "error-user-not-found": "No account found with this email.",
          "error-user-already-exists":
            "An account with this email already exists.",
          "success-login": "Login successful! Redirecting...",
          "success-signup": "Account created and logged in! Redirecting...",
          "btn-lang": "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
          "btn-lang-en": "English",
        },
        ar: {
          "logo-text": "Ù…ÙƒØªØ¨Ø© MYM",
          "logo-subtitle": "Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„Ù„ÙƒØªØ¨",
          "tab-login": "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
          "tab-signup": "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
          "label-login-email": "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
          "label-login-password": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
          "btn-login": "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ùƒ",
          "label-signup-name": "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„",
          "label-signup-email": "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
          "label-signup-password": "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
          "btn-signup": "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ",
          "divider-text": "Ø£Ùˆ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù…Ø¹",
          "firebase-text": "Firebase Firestore",
          "error-email-required": "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.",
          "error-password-required": "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.",
          "error-name-required": "Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„.",
          "error-credentials":
            "ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
          "error-user-not-found":
            "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.",
          "error-user-already-exists":
            "Ù‡Ù†Ø§Ùƒ Ø­Ø³Ø§Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ Ù…Ø±ØªØ¨Ø· Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.",
          "success-login": "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡...",
          "success-signup": "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„! Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡...",
          "btn-lang": "English",
          "btn-lang-en": "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
        },
      };

      // Ø¯Ø§Ù„Ø© Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
      function translatePage(lang) {
        const elementsToTranslate = Object.keys(translations[lang]);
        elementsToTranslate.forEach((key) => {
          const element = document.getElementById(key);
          if (element) {
            element.textContent = translations[lang][key];
          }
        });
      }

      // Ø¯Ø§Ù„Ø© Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©
      function toggleLanguage() {
        if (currentLanguage === "en") {
          currentLanguage = "ar";
          document.body.setAttribute("dir", "rtl");
          document.documentElement.setAttribute("lang", "ar");
        } else {
          currentLanguage = "en";
          document.body.setAttribute("dir", "ltr");
          document.documentElement.setAttribute("lang", "en");
        }
        translatePage(currentLanguage);
        // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø²Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø©
        document.getElementById("lang-toggle").textContent =
          translations[currentLanguage]["btn-lang"];
      }

      document.addEventListener("DOMContentLoaded", () => {
        // ØªØ±Ø¬Ù…Ø© Ø§Ù„ØµÙØ­Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (en)
        translatePage(currentLanguage);
        // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø²Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø©
        document.getElementById("lang-toggle").textContent =
          translations[currentLanguage]["btn-lang"];

        const tabs = document.querySelectorAll(".tab");
        const loginForm = document.getElementById("login-form");
        const signupForm = document.getElementById("signup-form");

        tabs.forEach((tab) => {
          tab.addEventListener("click", () => {
            tabs.forEach((t) => t.classList.remove("active"));
            tab.classList.add("active");

            if (tab.dataset.tab === "login") {
              loginForm.classList.remove("hidden");
              signupForm.classList.add("hidden");
            } else {
              loginForm.classList.add("hidden");
              signupForm.classList.remove("hidden");
            }

            clearMessages();
          });
        });

        loginForm.addEventListener("submit", handleLogin);
        signupForm.addEventListener("submit", handleSignup);

        function clearMessages() {
          [
            "login-error",
            "login-success",
            "signup-error",
            "signup-success",
          ].forEach((id) => {
            const element = document.getElementById(id);
            if (element) {
              element.textContent = "";
              element.style.opacity = "1";
              element.style.transition = "none";
            }
          });
        }

        function showError(formType, messageKey) {
          // Ù†Ù…Ø±Ø± Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¨Ø¯Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
          const errorElement = document.getElementById(`${formType}-error`);
          if (errorElement) {
            // Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const message =
              translations[currentLanguage][messageKey] || messageKey; // Ø§Ø­ØªÙŠØ§Ø·ÙŠ
            errorElement.textContent = message;
            errorElement.style.opacity = "0";
            setTimeout(() => {
              errorElement.style.transition = "opacity 0.3s";
              errorElement.style.opacity = "1";
            }, 10);
          }
        }

        function showSuccess(formType, messageKey) {
          // Ù†Ù…Ø±Ø± Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø¨Ø¯Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
          const successElement = document.getElementById(`${formType}-success`);
          if (successElement) {
            // Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const message =
              translations[currentLanguage][messageKey] || messageKey; // Ø§Ø­ØªÙŠØ§Ø·ÙŠ
            successElement.textContent = message;
            successElement.style.opacity = "0";
            setTimeout(() => {
              successElement.style.transition = "opacity 0.3s";
              successElement.style.opacity = "1";
            }, 10);
          }
        }

        function generateRedirectUrl(userId, name, email) {
          const encodedUserId = encodeURIComponent(userId);
          const encodedName = encodeURIComponent(name);
          const encodedEmail = encodeURIComponent(email);
          // Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ø§ ÙŠÙØªØ±Ø¬Ù…ØŒ Ù‡Ùˆ Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…
          return `https://mym-apps.vercel.app/library/explore?userId=${encodedUserId}&name=${encodedName}&email=${encodedEmail}`;
        }

        async function handleLogin(e) {
          e.preventDefault();
          clearMessages();

          const email = document.getElementById("login-email").value.trim();
          const password = document.getElementById("login-password").value;

          if (!email) {
            showError("login", "error-email-required");
            return;
          }
          if (!password) {
            showError("login", "error-password-required");
            return;
          }

          try {
            const querySnapshot = await db
              .collection("users")
              .where("email", "==", email)
              .get();

            if (querySnapshot.empty) {
              throw new Error("User not found");
            }

            const doc = querySnapshot.docs[0];
            const userId = doc.id;
            const userData = doc.data();

            const redirectUrl = generateRedirectUrl(
              userId,
              userData.name,
              userData.email
            );
            showSuccess("login", "success-login");
            setTimeout(() => {
              window.location.href = redirectUrl;
            }, 1500);
          } catch (error) {
            console.error("Login Error:", error);
            let messageKey = "error-credentials";
            if (error.message.includes("not found")) {
              messageKey = "error-user-not-found";
            }
            showError("login", messageKey);
          }
        }

        async function handleSignup(e) {
          e.preventDefault();
          clearMessages();

          const name = document.getElementById("signup-name").value.trim();
          const email = document.getElementById("signup-email").value.trim();
          const password = document.getElementById("signup-password").value;

          if (!name) {
            showError("signup", "error-name-required");
            return;
          }
          if (!email) {
            showError("signup", "error-email-required");
            return;
          }
          if (!password) {
            showError("signup", "error-password-required");
            return;
          }

          try {
            const existingQuery = await db
              .collection("users")
              .where("email", "==", email)
              .get();
            if (!existingQuery.empty) {
              throw new Error("User already exists");
            }

            const docRef = await db.collection("users").add({
              name: name,
              email: email,
              readCount: 0,
            });

            const userId = docRef.id;

            const redirectUrl = generateRedirectUrl(userId, name, email);
            showSuccess("signup", "success-signup");
            setTimeout(() => {
              window.location.href = redirectUrl;
            }, 1500);
          } catch (error) {
            console.error("Signup Error:", error);
            let messageKey = "error-credentials";
            if (error.message.includes("already exists")) {
              messageKey = "error-user-already-exists";
            }
            showError("signup", messageKey);
          }
        }
      });
    </script>
  </body>
</html>
