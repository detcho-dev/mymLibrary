<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Purchase Book</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="max-w-lg w-full bg-white p-6 rounded-lg shadow-lg">
        <h2 class="text-2xl font-bold mb-4 text-center text-gray-800">Complete Your Purchase</h2>

        <!-- فورم الطلب -->
        <form id="order-form" class="space-y-4">
            <!-- اسم الكتاب (غير قابل للتعديل) -->
            <label class="block text-sm font-semibold text-gray-700">Book Name</label>
            <input type="text" id="book-name" name="book_name" class="w-full px-4 py-2 border rounded bg-gray-100" readonly>

            <!-- السعر (غير قابل للتعديل) -->
            <label class="block text-sm font-semibold text-gray-700">Price</label>
            <input type="text" id="book-price" name="book_price" class="w-full px-4 py-2 border rounded bg-gray-100" readonly>

            <!-- بيانات العميل -->
            <label class="block text-sm font-semibold text-gray-700">Your Name</label>
            <input type="text" id="customer-name" name="customer_name" class="w-full px-4 py-2 border rounded" required>

            <label class="block text-sm font-semibold text-gray-700">Phone</label>
            <input type="tel" id="customer-phone" name="customer_phone" class="w-full px-4 py-2 border rounded" required>

            <label class="block text-sm font-semibold text-gray-700">Email</label>
            <input type="email" id="customer-email" name="customer_email" class="w-full px-4 py-2 border rounded" required>

            <!-- زر التأكيد -->
            <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded font-bold hover:bg-blue-700">Confirm Order</button>
        </form>
        
        <!-- رسالة نجاح الطلب -->
        <p id="success-message" class="text-green-600 font-semibold text-center mt-4 hidden">Order placed successfully! ✅</p>
    </div>

    <script>
        // استخراج القيم من الـ URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // ملء البيانات تلقائيًا عند تحميل الصفحة
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById("book-name").value = getQueryParam("name") || "Unknown Book";
            document.getElementById("book-price").value = getQueryParam("price") || "0.00 L.E.";
        });

        // إعداد EmailJS
        (function(){
            emailjs.init("YOUR_PUBLIC_KEY"); // استبدل YOUR_PUBLIC_KEY بالمفتاح الخاص بك من EmailJS
        })();

        // إرسال الطلب عند الضغط على "Confirm Order"
        document.getElementById("order-form").addEventListener("submit", function(event) {
            event.preventDefault();

            const serviceID = "YOUR_SERVICE_ID"; // استبدل بـ Service ID الخاص بك
            const templateID = "YOUR_TEMPLATE_ID"; // استبدل بـ Template ID الخاص بك

            const formData = {
                book_name: document.getElementById("book-name").value,
                book_price: document.getElementById("book-price").value,
                customer_name: document.getElementById("customer-name").value,
                customer_phone: document.getElementById("customer-phone").value,
                customer_email: document.getElementById("customer-email").value
            };

            emailjs.send(serviceID, templateID, formData)
                .then(() => {
                    document.getElementById("success-message").classList.remove("hidden");
                    document.getElementById("order-form").reset();
                })
                .catch(error => console.error("EmailJS Error:", error));
        });
    </script>

</body>
</html>
